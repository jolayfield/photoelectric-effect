import"./style-C8pZEPYV.js";class x{canvas;ctx;width;height;n=1;boxWidth=1;showProbability=!1;superpositionMode=!1;superN2=2;time=0;lastTimestamp=0;boxLeft=0;boxRight=0;boxTop=0;boxBottom=0;waveBaseline=0;constructor(t){this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("2D context not found");this.ctx=e,this.width=t.width,this.height=t.height,this.handleResize(),window.addEventListener("resize",()=>this.handleResize()),this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}handleResize(){this.canvas.parentElement&&(this.canvas.width=this.canvas.parentElement.clientWidth,this.canvas.height=this.canvas.parentElement.clientHeight,this.width=this.canvas.width,this.height=this.canvas.height,this.updateLayout())}updateLayout(){this.boxLeft=80,this.boxRight=this.width-40-40,this.boxTop=40,this.boxBottom=this.height-40,this.waveBaseline=this.height/2}psi(t,e){return Math.sqrt(2)*Math.sin(t*Math.PI*e)}energy(t){return t*t}update(t){this.time+=t*.003}draw(){this.ctx.clearRect(0,0,this.width,this.height);const t=this.ctx,e=this.boxRight-this.boxLeft,n=this.boxBottom-this.boxTop;t.strokeStyle="#2d3436",t.lineWidth=3,t.lineCap="round",t.beginPath(),t.moveTo(this.boxLeft,this.boxTop),t.lineTo(this.boxLeft,this.boxBottom),t.stroke(),t.beginPath(),t.moveTo(this.boxRight,this.boxTop),t.lineTo(this.boxRight,this.boxBottom),t.stroke(),t.beginPath(),t.strokeStyle="#b2bec3",t.lineWidth=1,t.setLineDash([5,5]),t.moveTo(this.boxLeft,this.waveBaseline),t.lineTo(this.boxRight,this.waveBaseline),t.stroke(),t.setLineDash([]);const a=t.createLinearGradient(this.boxLeft-40,0,this.boxLeft,0);a.addColorStop(0,"rgba(45, 52, 54, 0.3)"),a.addColorStop(1,"rgba(45, 52, 54, 0.05)"),t.fillStyle=a,t.fillRect(this.boxLeft-40,this.boxTop,40,n);const s=t.createLinearGradient(this.boxRight,0,this.boxRight+40,0);s.addColorStop(0,"rgba(45, 52, 54, 0.05)"),s.addColorStop(1,"rgba(45, 52, 54, 0.3)"),t.fillStyle=s,t.fillRect(this.boxRight,this.boxTop,40,n),t.fillStyle="#636e72",t.font="bold 14px Arial",t.textAlign="center",t.fillText("V = ∞",this.boxLeft-20,this.boxTop+20),t.fillText("V = ∞",this.boxRight+20,this.boxTop+20),t.fillText("V = 0",this.boxLeft+e/2,this.boxBottom+20);const o=300,i=n*.35;this.superpositionMode?this.drawSuperposition(t,o,i):this.drawSingleState(t,o,i),t.fillStyle="#636e72",t.font="12px Arial",t.textAlign="center",t.fillText("0",this.boxLeft,this.boxBottom+35),t.fillText("L",this.boxRight,this.boxBottom+35),t.fillStyle="#2d3436",t.font="bold 14px Merriweather",t.textAlign="center",this.superpositionMode?t.fillText(this.showProbability?"|c₁ψ₁ + c₂ψ₂|²":"Re(c₁ψ₁e^{-iω₁t} + c₂ψ₂e^{-iω₂t})",this.boxLeft+e/2,this.boxTop-15):t.fillText(this.showProbability?`|ψ${this.subscript(this.n)}(x)|²`:`ψ${this.subscript(this.n)}(x, t)`,this.boxLeft+e/2,this.boxTop-15)}subscript(t){return["₀","₁","₂","₃","₄","₅","₆","₇","₈"][t]||`${t}`}drawSingleState(t,e,n){const a=this.boxRight-this.boxLeft;if(this.showProbability){t.beginPath(),t.moveTo(this.boxLeft,this.waveBaseline);for(let o=0;o<=e;o++){const i=o/e,d=this.boxLeft+i*a,l=this.psi(this.n,i),r=l*l,h=this.waveBaseline-r*n;t.lineTo(d,h)}t.lineTo(this.boxRight,this.waveBaseline),t.closePath();const s=t.createLinearGradient(0,this.waveBaseline-n,0,this.waveBaseline);s.addColorStop(0,"rgba(61, 90, 254, 0.4)"),s.addColorStop(1,"rgba(61, 90, 254, 0.05)"),t.fillStyle=s,t.fill(),t.beginPath(),t.moveTo(this.boxLeft,this.waveBaseline);for(let o=0;o<=e;o++){const i=o/e,d=this.boxLeft+i*a,l=this.psi(this.n,i),r=l*l,h=this.waveBaseline-r*n;t.lineTo(d,h)}t.strokeStyle="#3d5afe",t.lineWidth=2.5,t.shadowColor="rgba(61, 90, 254, 0.5)",t.shadowBlur=8,t.stroke(),t.shadowBlur=0}else{const s=this.energy(this.n),o=Math.cos(s*this.time);t.beginPath();for(let i=0;i<=e;i++){const d=i/e,l=this.boxLeft+d*a,r=this.psi(this.n,d)*o,h=this.waveBaseline-r*n*.5;i===0?t.moveTo(l,h):t.lineTo(l,h)}t.strokeStyle="#3d5afe",t.lineWidth=2.5,t.shadowColor="rgba(61, 90, 254, 0.5)",t.shadowBlur=8,t.stroke(),t.shadowBlur=0,t.beginPath(),t.moveTo(this.boxLeft,this.waveBaseline);for(let i=0;i<=e;i++){const d=i/e,l=this.boxLeft+d*a,r=this.psi(this.n,d)*o,h=this.waveBaseline-r*n*.5;t.lineTo(l,Math.min(h,this.waveBaseline))}t.lineTo(this.boxRight,this.waveBaseline),t.closePath(),t.fillStyle="rgba(61, 90, 254, 0.12)",t.fill(),t.beginPath(),t.moveTo(this.boxLeft,this.waveBaseline);for(let i=0;i<=e;i++){const d=i/e,l=this.boxLeft+d*a,r=this.psi(this.n,d)*o,h=this.waveBaseline-r*n*.5;t.lineTo(l,Math.max(h,this.waveBaseline))}t.lineTo(this.boxRight,this.waveBaseline),t.closePath(),t.fillStyle="rgba(255, 64, 129, 0.12)",t.fill()}}drawSuperposition(t,e,n){const a=this.boxRight-this.boxLeft,s=this.n,o=this.superN2,i=1/Math.sqrt(2);if(this.showProbability){const d=this.energy(o)-this.energy(s),l=Math.cos(d*this.time);t.beginPath(),t.moveTo(this.boxLeft,this.waveBaseline);for(let h=0;h<=e;h++){const g=h/e,p=this.boxLeft+g*a,b=this.psi(s,g),c=this.psi(o,g),f=i*i*(b*b+c*c+2*b*c*l),v=this.waveBaseline-f*n;t.lineTo(p,v)}t.lineTo(this.boxRight,this.waveBaseline),t.closePath();const r=t.createLinearGradient(0,this.waveBaseline-n,0,this.waveBaseline);r.addColorStop(0,"rgba(156, 39, 176, 0.4)"),r.addColorStop(1,"rgba(156, 39, 176, 0.05)"),t.fillStyle=r,t.fill(),t.beginPath(),t.moveTo(this.boxLeft,this.waveBaseline);for(let h=0;h<=e;h++){const g=h/e,p=this.boxLeft+g*a,b=this.psi(s,g),c=this.psi(o,g),f=i*i*(b*b+c*c+2*b*c*l),v=this.waveBaseline-f*n;t.lineTo(p,v)}t.strokeStyle="#9c27b0",t.lineWidth=2.5,t.shadowColor="rgba(156, 39, 176, 0.5)",t.shadowBlur=8,t.stroke(),t.shadowBlur=0}else{const d=this.energy(s),l=this.energy(o);t.beginPath();for(let r=0;r<=e;r++){const h=r/e,g=this.boxLeft+h*a,p=i*this.psi(s,h)*Math.cos(d*this.time)+i*this.psi(o,h)*Math.cos(l*this.time),b=this.waveBaseline-p*n*.5;r===0?t.moveTo(g,b):t.lineTo(g,b)}t.strokeStyle="#9c27b0",t.lineWidth=2.5,t.shadowColor="rgba(156, 39, 176, 0.5)",t.shadowBlur=8,t.stroke(),t.shadowBlur=0}}loop(t){this.lastTimestamp||(this.lastTimestamp=t);const e=Math.min(t-this.lastTimestamp,100);this.lastTimestamp=t,this.update(e),this.draw(),requestAnimationFrame(this.loop)}}class m{canvas;ctx;width;height;currentN=1;maxN=8;constructor(t){this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("2D context not found");this.ctx=e,this.width=t.width,this.height=t.height,this.handleResize(),window.addEventListener("resize",()=>this.handleResize())}handleResize(){this.canvas.parentElement&&(this.canvas.width=this.canvas.parentElement.clientWidth,this.canvas.height=this.canvas.parentElement.clientHeight||200,this.width=this.canvas.width,this.height=this.canvas.height,this.draw())}getY(t){const e=t*t,n=this.maxN*this.maxN,a=e/n;return this.height-30-a*(this.height-60)}draw(){this.ctx.clearRect(0,0,this.width,this.height);const t=this.ctx,e=50,n=this.width-70;t.font="12px Arial",t.textAlign="right",t.textBaseline="middle";for(let s=1;s<=this.maxN;s++){const o=this.getY(s);t.beginPath(),t.strokeStyle=s===this.currentN?"#3d5afe":"#ddd",t.lineWidth=s===this.currentN?2.5:1,t.moveTo(e,o),t.lineTo(e+n,o),t.stroke(),t.fillStyle=s===this.currentN?"#3d5afe":"#999",t.font=s===this.currentN?"bold 12px Arial":"12px Arial",t.fillText(`n=${s}`,e-5,o),t.textAlign="left",t.fillText(`${s*s} E₁`,e+n+5,o),t.textAlign="right"}const a=this.getY(this.currentN);t.beginPath(),t.fillStyle="#3d5afe",t.shadowColor="rgba(61, 90, 254, 0.5)",t.shadowBlur=10,t.arc(e+n/2,a,6,0,Math.PI*2),t.fill(),t.shadowBlur=0}}document.addEventListener("DOMContentLoaded",()=>{const w=document.getElementById("pbox-canvas"),t=document.getElementById("energy-level-canvas");if(!w||!t)throw new Error("Canvas elements not found");const e=new x(w),n=new m(t),a=document.getElementById("quantum-n"),s=document.getElementById("quantum-n-val"),o=document.getElementById("display-mode"),i=document.getElementById("superposition-toggle"),d=document.getElementById("super-n2-group"),l=document.getElementById("super-n2"),r=document.getElementById("super-n2-val"),h=document.getElementById("energy-val"),g=document.getElementById("nodes-val"),p=document.getElementById("wavelength-val"),b=()=>{const c=parseInt(a.value);if(e.n=c,e.showProbability=o.value==="probability",e.superpositionMode=i.checked,d.style.display=i.checked?"flex":"none",i.checked){const f=parseInt(l.value);e.superN2=f,r.textContent=`n₂ = ${f}`}s.textContent=`n = ${c}`,h.textContent=`${c*c} E₁`,g.textContent=`${c-1}`,c===1?p.textContent="2L":c===2?p.textContent="L":p.textContent=`2L/${c}`,n.currentN=c,n.draw()};a.addEventListener("input",b),o.addEventListener("change",b),i.addEventListener("change",b),l.addEventListener("input",b),b()});
